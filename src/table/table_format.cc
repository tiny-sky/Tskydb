#include "table_format.h"

#include "util/encoding.h"
#include "util/status.h"

namespace Tskydb {

const BlockHandle BlockHandle::kNullBlockHandle(0, 0);

void BlockHandle::EncodeTo(std::string *dst) const {
  // Sanity check that all fields have been set
  assert(offset_ != ~static_cast<uint64_t>(0));
  assert(size_ != ~static_cast<uint64_t>(0));
  PutVarint64(dst, offset_);
  PutVarint64(dst, size_);
}

Status BlockHandle::DecodeFrom(Slice *input) {
  if (GetVarint64(input, &offset_) && GetVarint64(input, &size_)) {
    return Status::OK();
  } else {
    return Status::Corruption("bad block handle");
  }
}
}  // namespace Tskydb
